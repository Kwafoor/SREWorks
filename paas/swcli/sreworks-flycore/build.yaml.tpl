componentType: K8S_MICROSERVICE
componentName: paas-authproxy
options:
  containers:
    - ports:
        - containerPort: 7001
      name: server
      build:
        imagePush: true
        imagePushRegistry: ${IMAGE_PUSH_REGISTRY}
        args:
          TAG: ack
        dockerfileTemplateArgs:
          MAVEN_IMAGE: ${MAVEN_IMAGE}
          JRE8_IMAGE: ${JRE8_IMAGE}
        dockerfileTemplate: Dockerfile.tpl
        branch: master
        repo: http://gitlab.ca221ae8860d9421688e59c8ab45c8b21.cn-hangzhou.alicontainer.com/sreworks/github-sreworks.git
        repoPath: paas/tesla-authproxy
        ciAccount: sreworks
        ciToken: zwC8xJJ8z6FVZF6icqXf
  initContainers:
    - name: db-migration
      build:
        imagePush: true
        imagePushRegistry: ${IMAGE_PUSH_REGISTRY}
        args:
          TAG: ack
        dockerfileTemplateArgs:
          MIGRATE_IMAGE: ${MIGRATE_IMAGE}
        dockerfileTemplate: Dockerfile_db_migration.tpl
        branch: master
        repo: http://gitlab.ca221ae8860d9421688e59c8ab45c8b21.cn-hangzhou.alicontainer.com/sreworks/github-sreworks.git
        repoPath: paas/tesla-authproxy
        ciAccount: sreworks
        ciToken: zwC8xJJ8z6FVZF6icqXf
  env:
    - AAS_DIRECT_LOGIN_URL
    - AAS_INNER_ENDPOINT
    - AAS_LOGIN_URL
    - AAS_LOGOUT_URL
    - AAS_OPENAPI_DOMAIN
    - AAS_OPENAPI_URL
    - AAS_POP_KEY
    - AAS_POP_SECRET
    - ABM_CLUSTER
    - ACCOUNT_BASE_ACCESS_ID
    - ACCOUNT_BASE_ACCESS_KEY
    - ACCOUNT_BASE_ID
    - ACCOUNT_BASE_PK
    - ACCOUNT_BASE_SECRET_KEY
    - ACCOUNT_ODPS_ACCESS_ID
    - ACCOUNT_ODPS_ACCESS_KEY
    - ACCOUNT_ODPS_ID
    - ACCOUNT_ODPS_PK
    - ACCOUNT_ODPS_SECRET_KEY
    - ACCOUNT_SUPER_ACCESS_ID
    - ACCOUNT_SUPER_ACCESS_KEY
    - ACCOUNT_SUPER_ID
    - ACCOUNT_SUPER_PK
    - ACCOUNT_SUPER_SECRET_KEY
    - ACCOUNT_SUPER_CLIENT_ID
    - ACCOUNT_SUPER_CLIENT_SECRET
    - ASS_CALLBACK_URL
    - CENTER_REGION
    - CICD_PROJECTID
    - CLOUD_TYPE
    - CLUSTER_SCALE_FLAG
    - COOKIE_DOMAIN
    - DATABASE_AUTH_SERVICE_MGR_CLASS_NAME
    - DATABASE_LOGIN_INTERCEPTOR_CLASS_NAME
    - DB_HOST
    - DB_NAME
    - DB_PASSWORD
    - DB_PORT
    - DB_USER
    - DNS_PAAS_HOME
    - DNS_PAAS_HOME_DISASTER
    - DUBBO_DOMAIN
    - ENDPOINT_GRPC_PAAS_CHECK
    - ENDPOINT_GRPC_PAAS_TASKPLATFORM
    - ENDPOINT_GRPC_PAAS_TIANJI
    - ENDPOINT_PAAS_AUTHPROXY
    - ENDPOINT_PAAS_CHANNEL
    - ENDPOINT_PAAS_CHECK
    - ENDPOINT_PAAS_CMDB
    - ENDPOINT_PAAS_CONNECTOR
    - ENDPOINT_PAAS_DR_MUTILCLOUD
    - ENDPOINT_PAAS_FAAS_MANAGER
    - ENDPOINT_PAAS_FRONTEND_SERVICE
    - ENDPOINT_PAAS_GATEWAY
    - ENDPOINT_PAAS_GRAFANA
    - ENDPOINT_PAAS_HOME
    - ENDPOINT_PAAS_MINIO
    - ENDPOINT_PAAS_PROCESS
    - ENDPOINT_PAAS_PRODUCTOPS
    - ENDPOINT_PAAS_STARAGENT
    - ENDPOINT_PAAS_TASKPLATFORM
    - ENDPOINT_PAAS_TIANJI
    - ENDPOINT_PAAS_TKGONE
    - ENDPOINT_SAAS_BASE_CONSOLE
    - ENDPOINT_SAAS_BLINK
    - ENDPOINT_SAAS_CALIFORNIA
    - ENDPOINT_SAAS_DATAHUB
    - ENDPOINT_SAAS_DATAWORKS
    - ENDPOINT_SAAS_DWG
    - ENDPOINT_SAAS_EBLINK
    - ENDPOINT_SAAS_ELASTICSEARCH
    - ENDPOINT_SAAS_GRAPHCOMPUTE
    - ENDPOINT_SAAS_HOLO
    - ENDPOINT_SAAS_ODPS
    - ENDPOINT_SAAS_STANDARD_CLUSTER
    - ENDPOINT_SAAS_TESLA
    - ENV_TYPE
    - IDC_MAP
    - IDC_ROOM
    - LOGIN_URL
    - NETWORK_PROTOCOL
    - OAM_ENDPOINT
    - OAM_POP_KEY
    - OAM_POP_SECRET
    - REDIS_DB
    - REDIS_HOST
    - REDIS_PASSWORD
    - REDIS_PORT
    - REGION
    - TESLA_ADMIN_USERS
    - TESLA_AUTHPROXY_OAUTH2_ACCESS_TOKEN_URI
    - TESLA_AUTHPROXY_OAUTH2_CLIENT_ID
    - TESLA_AUTHPROXY_OAUTH2_CLIENT_SECRET
    - TESLA_AUTHPROXY_OAUTH2_REDIRECT_URI
    - TESLA_AUTHPROXY_OAUTH2_USER_AUTHORIZATION_URI
    - TESLA_AUTHPROXY_OAUTH2_USER_INFO_URI
    - UMM_AK_ID
    - UMM_AK_SECRET
    - UMM_ENDPOINT
    - URL_PAAS_GATEWAY
    - URL_PAAS_HOME
    - VIP_IP_PAAS_GRAFANA
    - VIP_IP_PAAS_HOME
    - VIP_IP_PAAS_TASKPLATFORM_GRPC
    - VIP_IP_PAAS_TKGONE
    - VIP_PORT_PAAS_TASKPLATFORM_GRPC
    - VIP_PORT_PAAS_TKGONE
    - VM_IP_LIST
    - ZONE
    - ZOOKEEPER_ENDPOINT
    - ZOOKEEPER_HOSTS
    - ZOOKEEPER_PORT
---
componentType: K8S_JOB
componentName: paas-authproxy-postrun
options:
  job:
    name: job
    build:
      imagePush: true
      imagePushRegistry: ${IMAGE_PUSH_REGISTRY}
      args:
        TAG: ack
      dockerfileTemplateArgs:
        POSTRUN_IMAGE: ${POSTRUN_IMAGE}
      dockerfileTemplate: Dockerfile_postrun.tpl
      branch: master
      repo: http://gitlab.ca221ae8860d9421688e59c8ab45c8b21.cn-hangzhou.alicontainer.com/sreworks/github-sreworks.git
      repoPath: paas/tesla-authproxy
      ciAccount: sreworks
      ciToken: zwC8xJJ8z6FVZF6icqXf
 
  env:
    - AAS_DIRECT_LOGIN_URL
    - AAS_INNER_ENDPOINT
    - AAS_LOGIN_URL
    - AAS_LOGOUT_URL
    - AAS_OPENAPI_DOMAIN
    - AAS_OPENAPI_URL
    - AAS_POP_KEY
    - AAS_POP_SECRET
    - ABM_CLUSTER
    - ACCOUNT_BASE_ACCESS_ID
    - ACCOUNT_BASE_ACCESS_KEY
    - ACCOUNT_BASE_ID
    - ACCOUNT_BASE_PK
    - ACCOUNT_BASE_SECRET_KEY
    - ACCOUNT_ODPS_ACCESS_ID
    - ACCOUNT_ODPS_ACCESS_KEY
    - ACCOUNT_ODPS_ID
    - ACCOUNT_ODPS_PK
    - ACCOUNT_ODPS_SECRET_KEY
    - ACCOUNT_SUPER_ACCESS_ID
    - ACCOUNT_SUPER_ACCESS_KEY
    - ACCOUNT_SUPER_ID
    - ACCOUNT_SUPER_PK
    - ACCOUNT_SUPER_SECRET_KEY
    - ACCOUNT_SUPER_CLIENT_ID
    - ACCOUNT_SUPER_CLIENT_SECRET
    - ASS_CALLBACK_URL
    - CENTER_REGION
    - CICD_PROJECTID
    - CLOUD_TYPE
    - CLUSTER_SCALE_FLAG
    - COOKIE_DOMAIN
    - DATABASE_AUTH_SERVICE_MGR_CLASS_NAME
    - DATABASE_LOGIN_INTERCEPTOR_CLASS_NAME
    - DB_HOST
    - DB_NAME
    - DB_PASSWORD
    - DB_PORT
    - DB_USER
    - DNS_PAAS_HOME
    - DNS_PAAS_HOME_DISASTER
    - DUBBO_DOMAIN
    - ENDPOINT_GRPC_PAAS_CHECK
    - ENDPOINT_GRPC_PAAS_TASKPLATFORM
    - ENDPOINT_GRPC_PAAS_TIANJI
    - ENDPOINT_PAAS_AUTHPROXY
    - ENDPOINT_PAAS_CHANNEL
    - ENDPOINT_PAAS_CHECK
    - ENDPOINT_PAAS_CMDB
    - ENDPOINT_PAAS_CONNECTOR
    - ENDPOINT_PAAS_DR_MUTILCLOUD
    - ENDPOINT_PAAS_FAAS_MANAGER
    - ENDPOINT_PAAS_FRONTEND_SERVICE
    - ENDPOINT_PAAS_GATEWAY
    - ENDPOINT_PAAS_GRAFANA
    - ENDPOINT_PAAS_HOME
    - ENDPOINT_PAAS_MINIO
    - ENDPOINT_PAAS_PROCESS
    - ENDPOINT_PAAS_PRODUCTOPS
    - ENDPOINT_PAAS_STARAGENT
    - ENDPOINT_PAAS_TASKPLATFORM
    - ENDPOINT_PAAS_TIANJI
    - ENDPOINT_PAAS_TKGONE
    - ENDPOINT_SAAS_BASE_CONSOLE
    - ENDPOINT_SAAS_BLINK
    - ENDPOINT_SAAS_CALIFORNIA
    - ENDPOINT_SAAS_DATAHUB
    - ENDPOINT_SAAS_DATAWORKS
    - ENDPOINT_SAAS_DWG
    - ENDPOINT_SAAS_EBLINK
    - ENDPOINT_SAAS_ELASTICSEARCH
    - ENDPOINT_SAAS_GRAPHCOMPUTE
    - ENDPOINT_SAAS_HOLO
    - ENDPOINT_SAAS_ODPS
    - ENDPOINT_SAAS_STANDARD_CLUSTER
    - ENDPOINT_SAAS_TESLA
    - ENV_TYPE
    - IDC_MAP
    - IDC_ROOM
    - LOGIN_URL
    - NETWORK_PROTOCOL
    - OAM_ENDPOINT
    - OAM_POP_KEY
    - OAM_POP_SECRET
    - REDIS_DB
    - REDIS_HOST
    - REDIS_PASSWORD
    - REDIS_PORT
    - REGION
    - TESLA_ADMIN_USERS
    - TESLA_AUTHPROXY_OAUTH2_ACCESS_TOKEN_URI
    - TESLA_AUTHPROXY_OAUTH2_CLIENT_ID
    - TESLA_AUTHPROXY_OAUTH2_CLIENT_SECRET
    - TESLA_AUTHPROXY_OAUTH2_REDIRECT_URI
    - TESLA_AUTHPROXY_OAUTH2_USER_AUTHORIZATION_URI
    - TESLA_AUTHPROXY_OAUTH2_USER_INFO_URI
    - UMM_AK_ID
    - UMM_AK_SECRET
    - UMM_ENDPOINT
    - URL_PAAS_GATEWAY
    - URL_PAAS_HOME
    - VIP_IP_PAAS_GRAFANA
    - VIP_IP_PAAS_HOME
    - VIP_IP_PAAS_TASKPLATFORM_GRPC
    - VIP_IP_PAAS_TKGONE
    - VIP_PORT_PAAS_TASKPLATFORM_GRPC
    - VIP_PORT_PAAS_TKGONE
    - VM_IP_LIST
    - ZONE
    - ZOOKEEPER_ENDPOINT
    - ZOOKEEPER_HOSTS
    - ZOOKEEPER_PORT
---
componentType: K8S_MICROSERVICE
componentName: paas-frontend
options:
  containers:
    - ports:
        - containerPort: 80
      name: server
      build:
        imagePush: true
        imagePushRegistry: ${IMAGE_PUSH_REGISTRY}
        args:
          TAG: master
          OSSUTIL_URL: http://gosspublic.alicdn.com/ossutil/1.6.10/ossutil64
        dockerfileTemplateArgs:
          ALPINE_IMAGE: alpine:latest
        dockerfileTemplate: Dockerfile.tpl
        branch: master
        repo: http://gitlab.ca221ae8860d9421688e59c8ab45c8b21.cn-hangzhou.alicontainer.com/sreworks/github-sreworks.git
        repoPath: paas/sw-frontend
        ciAccount: sreworks
        ciToken: zwC8xJJ8z6FVZF6icqXf
 
  env:
    - ABM_CLUSTER
    - CENTER_REGION
    - CICD_PROJECTID
    - CLOUD_TYPE
    - CLUSTER_SCALE_FLAG
    - COOKIE_DOMAIN
    - DNS_PAAS_COMPATIBLE_HOME
    - DNS_PAAS_HOME
    - DNS_PAAS_HOME_DISASTER
    - ENDPOINT_GRPC_PAAS_CHECK
    - ENDPOINT_GRPC_PAAS_TASKPLATFORM
    - ENDPOINT_GRPC_PAAS_TIANJI
    - ENDPOINT_PAAS_AUTHPROXY
    - ENDPOINT_PAAS_CHANNEL
    - ENDPOINT_PAAS_CHECK
    - ENDPOINT_PAAS_CMDB
    - ENDPOINT_PAAS_CONNECTOR
    - ENDPOINT_PAAS_DR_MUTILCLOUD
    - ENDPOINT_PAAS_FAAS_MANAGER
    - ENDPOINT_PAAS_FRONTEND_SERVICE
    - ENDPOINT_PAAS_GATEWAY
    - ENDPOINT_PAAS_GRAFANA
    - ENDPOINT_PAAS_HOME
    - ENDPOINT_PAAS_MINIO
    - ENDPOINT_PAAS_PROCESS
    - ENDPOINT_PAAS_PRODUCTOPS
    - ENDPOINT_PAAS_STARAGENT
    - ENDPOINT_PAAS_TASKPLATFORM
    - ENDPOINT_PAAS_TIANJI
    - ENDPOINT_PAAS_TKGONE
    - ENDPOINT_SAAS_BASE_CONSOLE
    - ENDPOINT_SAAS_BLINK
    - ENDPOINT_SAAS_CALIFORNIA
    - ENDPOINT_SAAS_DATAHUB
    - ENDPOINT_SAAS_DATAWORKS
    - ENDPOINT_SAAS_DWG
    - ENDPOINT_SAAS_EBLINK
    - ENDPOINT_SAAS_ELASTICSEARCH
    - ENDPOINT_SAAS_GRAPHCOMPUTE
    - ENDPOINT_SAAS_HOLO
    - ENDPOINT_SAAS_ODPS
    - ENDPOINT_SAAS_STANDARD_CLUSTER
    - ENDPOINT_SAAS_TESLA
    - ENV_TYPE
    - EXTERNAL_DATAWORKS_CONSOLE_URL
    - IDC_MAP
    - IDC_ROOM
    - NETWORK_PROTOCOL
    - REGION
    - URL_PAAS_GATEWAY
    - URL_PAAS_HOME
    - VIP_IP_PAAS_GRAFANA
    - VIP_IP_PAAS_HOME
    - VIP_IP_PAAS_TASKPLATFORM_GRPC
    - VIP_IP_PAAS_TKGONE
    - VIP_PORT_PAAS_TASKPLATFORM_GRPC
    - VIP_PORT_PAAS_TKGONE
    - VM_IP_LIST
    - ZONE
---
componentType: K8S_MICROSERVICE
componentName: paas-gateway
options:
  containers:
    - ports:
        - containerPort: 7001
        - containerPort: 7002
      name: server
      build:
        imagePush: true
        imagePushRegistry: ${IMAGE_PUSH_REGISTRY}
        args:
          TAG: ack
        dockerfileTemplateArgs:
          MAVEN_IMAGE: ${MAVEN_IMAGE}
          JRE8_IMAGE: ${JRE8_IMAGE}
        dockerfileTemplate: Dockerfile_paas.tpl
        branch: master
        repo: http://gitlab.ca221ae8860d9421688e59c8ab45c8b21.cn-hangzhou.alicontainer.com/sreworks/github-sreworks.git
        repoPath: paas/tesla-gateway
        ciAccount: sreworks
        ciToken: zwC8xJJ8z6FVZF6icqXf
 
  env:
    - DB_HOST
    - DB_PORT
    - DB_USER
    - DB_PASSWORD
    - DB_NAME
    - REDIS_HOST
    - REDIS_PORT
    - REDIS_DB
    - REDIS_PASSWORD
    - REGION
    - IDC_ROOM
    - AUTH_ADMIN_TOKEN
    - ENDPOINT_PAAS_AUTHPROXY
    - AUTH_COOKIE_KEY
    - AUTH_COOKIE_NAME
    - AUTH_JWT_SECRET
    - TESLA_AUTH_APP
    - TESLA_AUTH_KEY
    - STORE_NACOS_DATA_ID
    - STORE_NACOS_GROUP
    - NACOS_NAMESPACE
    - NACOS_ENDPOINT
    - MANAGER_SERVER_PORT

---


componentType: K8S_JOB
componentName: paas-gateway-route-config
options:
  env:
    - ENDPOINT_PAAS_GATEWAY
    - ACCOUNT_SUPER_CLIENT_ID
    - ACCOUNT_SUPER_CLIENT_SECRET
    - ACCOUNT_SUPER_ID
    - ACCOUNT_SUPER_SECRET_KEY
  job:
    imagePush: registry.cn-hangzhou.aliyuncs.com/alisre
    build:
      imagePush: true
      imagePushRegistry: ${IMAGE_PUSH_REGISTRY}
      dockerfileTemplate: Dockerfile_route_config.tpl
      branch: master
      repo: http://gitlab.ca221ae8860d9421688e59c8ab45c8b21.cn-hangzhou.alicontainer.com/sreworks/github-sreworks.git
      repoPath: paas/tesla-gateway
      ciAccount: sreworks
      ciToken: zwC8xJJ8z6FVZF6icqXf
      dockerfileTemplateArgs:
        PYTHON2_IMAGE: ${PYTHON2_IMAGE}
    name: route-config


---
componentType: K8S_MICROSERVICE
componentName: paas-productops
options:
  containers:
    - command:
        - "/app/sbin/run_server.sh"
      ports:
        - containerPort: 80
      name: server
      build:
        imagePush: true
        imagePushRegistry: ${IMAGE_PUSH_REGISTRY}
        args:
          TAG: ack
        dockerfileTemplateArgs:
          PYTHON2_IMAGE: ${PYTHON2_IMAGE}
        dockerfileTemplate: Dockerfile.tpl
        branch: master
        repo: http://gitlab.ca221ae8860d9421688e59c8ab45c8b21.cn-hangzhou.alicontainer.com/sreworks/github-sreworks.git
        repoPath: paas/tesla-product-ops
        ciAccount: sreworks
        ciToken: zwC8xJJ8z6FVZF6icqXf
 
  initContainers:
    - name: db-migration
      build:
        imagePush: true
        imagePushRegistry: ${IMAGE_PUSH_REGISTRY}
        args:
          TAG: ack
        dockerfileTemplateArgs:
          MIGRATE_IMAGE: ${MIGRATE_IMAGE}
        dockerfileTemplate: Dockerfile_db_migration.tpl
        branch: master
        repo: http://gitlab.ca221ae8860d9421688e59c8ab45c8b21.cn-hangzhou.alicontainer.com/sreworks/github-sreworks.git
        repoPath: paas/tesla-product-ops
        ciAccount: sreworks
        ciToken: zwC8xJJ8z6FVZF6icqXf
 
  env:
    - CLUSTER_SCALE_FLAG
    - CLOUD_TYPE
    - ENV_TYPE
    - NETWORK_PROTOCOL
    - ZONE
    - REGION
    - ABM_CLUSTER
    - COOKIE_DOMAIN
    - CICD_PROJECTID
    - IDC_MAP
    - IDC_ROOM
    - CENTER_REGION
    - REQUESTED_IP
    - CONTAINER_IP_LIST
    - TASK_IP
    - INTERNET_DOMAIN
    - DR_MULTIREGION
    - DR_MULTIZONE
    - VM_IP_LIST
    - DB_HOST
    - DB_PORT
    - DB_NAME
    - DB_NAME_AG
    - DB_NAME_CALIFORNIA
    - DB_NAME_AUTHPROXY
    - DB_NAME_TKGONE
    - DB_NAME_TIANJI
    - DB_NAME_CHECK
    - DB_USER
    - DB_PASSWORD
    - DB_HOST_DI
    - DB_PORT_DI
    - DB_USER_DI
    - DB_PASSWORD_DI
    - DB_NAME_DI
    - REDIS_HOST
    - REDIS_PORT
    - REDIS_DB
    - REDIS_PASSWORD
    - ZOOKEEPER_ENDPOINT
    - ZOOKEEPER_HOSTS
    - ZOOKEEPER_PORT
    - ELASTICSEARCH_HOST
    - ELASTICSEARCH_PORT
    - ELASTICSEARCH_USER
    - ELASTICSEARCH_PASSWORD
    - ENDPOINT_PAAS_NACOS
    - NACOS_NAMESPACE
    - CONTAINER_IP_LIST_TKGONE
    - CONTAINER_IP_LIST_SAAS_TESLA
    - CONTAINER_IP_LIST_SAAS_ODPS
    - CONTAINER_IP_LIST_SAAS_HOLO
    - CONTAINER_IP_LIST_SAAS_GRAPHCOMPUTE
    - CONTAINER_IP_LIST_SAAS_ELASTICSEARCH
    - CONTAINER_IP_LIST_SAAS_DATAWORKS
    - CONTAINER_IP_LIST_SAAS_DATAHUB
    - CONTAINER_IP_LIST_SAAS_BLINK
    - STARAGENT_KEY
    - STARAGENT_SECRET
    - URL_PAAS_HOME
    - URL_PAAS_GATEWAY
    - DNS_PAAS_HOME
    - ENDPOINT_PAAS_APPMANAGER
    - DNS_PAAS_HOME_DISASTER
    - ENDPOINT_PAAS_HOME
    - ENDPOINT_PAAS_MINIO
    - ENDPOINT_PAAS_PRODUCTOPS
    - ENDPOINT_PAAS_TKGONE
    - ENDPOINT_PAAS_TIANJI
    - ENDPOINT_PAAS_AUTHPROXY
    - ENDPOINT_PAAS_CHANNEL
    - ENDPOINT_PAAS_GRAFANA
    - ENDPOINT_PAAS_FAAS_MANAGER
    - ENDPOINT_PAAS_CMDB
    - ENDPOINT_PAAS_GATEWAY
    - ENDPOINT_PAAS_CONNECTOR
    - ENDPOINT_PAAS_CHECK
    - ENDPOINT_PAAS_STARAGENT
    - ENDPOINT_PAAS_PROCESS
    - ENDPOINT_PAAS_FRONTEND_SERVICE
    - ENDPOINT_PAAS_TASKPLATFORM
    - ENDPOINT_SAAS_BLINK
    - ENDPOINT_SAAS_DATAHUB
    - ENDPOINT_SAAS_DATAWORKS
    - ENDPOINT_SAAS_ELASTICSEARCH
    - ENDPOINT_SAAS_GRAPHCOMPUTE
    - ENDPOINT_SAAS_HOLO
    - ENDPOINT_SAAS_ODPS
    - ENDPOINT_SAAS_TESLA
    - ENDPOINT_SAAS_CALIFORNIA
    - ENDPOINT_SAAS_BASE_CONSOLE
    - ENDPOINT_SAAS_EBLINK
    - ENDPOINT_SAAS_STANDARD_CLUSTER
    - ENDPOINT_SAAS_DWG
    - ENDPOINT_GRPC_PAAS_TIANJI
    - ENDPOINT_GRPC_PAAS_TASKPLATFORM
    - ENDPOINT_GRPC_PAAS_CHECK
    - ENDPOINT_PAAS_DR_MUTILCLOUD
    - VIP_IP_PAAS_HOME
    - VIP_IP_PAAS_GRAFANA
    - VIP_IP_PAAS_TKGONE
    - VIP_IP_PAAS_TASKPLATFORM_GRPC
    - VIP_PORT_PAAS_TKGONE
    - VIP_PORT_PAAS_TASKPLATFORM_GRPC
    - MINIO_ACCESS_KEY
    - MINIO_SECRET_KEY
    - ACCOUNT_SUPER_CLIENT_ID
    - ACCOUNT_SUPER_CLIENT_SECRET
    - ACCOUNT_SUPER_ID
    - ACCOUNT_SUPER_PK
    - ACCOUNT_SUPER_ACCESS_ID
    - ACCOUNT_SUPER_ACCESS_KEY
    - ACCOUNT_SUPER_SECRET_KEY
    - ACCOUNT_ODPS_ID
    - ACCOUNT_ODPS_PK
    - ACCOUNT_ODPS_ACCESS_ID
    - ACCOUNT_ODPS_ACCESS_KEY
    - ACCOUNT_ODPS_SECRET_KEY
    - ACCOUNT_BASE_ID
    - ACCOUNT_BASE_PK
    - ACCOUNT_BASE_ACCESS_ID
    - ACCOUNT_BASE_ACCESS_KEY
    - ACCOUNT_BASE_SECRET_KEY
    - ODPS_SERVICE_ENDPOINT
    - ODPS_ACCOUNT_ID
    - ODPS_ACCOUNT_KEY
    - ODPS_CLUSTER_NAME
    - ODPS_LOGVIEW_HOST
    - ODPS_GRIP_ENDPOINT
    - ODPS_GRIP_PORT
    - ODPS_CONTROLLER_IP
    - ODPS_OTS_HOST
    - ODPS_OTS_TABLE_NAME
    - ODPS_OTS_ACCESS_ID
    - ODPS_OTS_ACCESS_KEY
    - DATAWORKS_INTEGRATE_FLAG
    - DATAWORKS_TENANT_URL
    - DATAWORKS_KEY
    - DATAWORKS_TOKEN
    - DATAWORKS_IDE_URL
    - DATAWORKS_CLUSTER
    - DATAWORKS_API_DOMAIN
    - DATAWORKS_CONSOLE_URL
    - DATAWORKS_ALISA_URL
    - BASE_KEY
    - BASE_TOKEN
    - BASE_IDE_URL
    - BASE_TENANT_URL
    - BASE_CLOUDOPENAPI_URL
    - BASE_META_URL
    - EXTERNAL_DATAWORKS_CONSOLE_URL
    - DATAHUB_DB_HOST
    - DATAHUB_DB_PORT
    - DATAHUB_DB_USER
    - DATAHUB_DB_NAME
    - DATAHUB_DB_PASSWORD
    - DATAHUB_SERVICE_CENTER_DB_USER
    - DATAHUB_SERVICE_CENTER_DB_PASSWORD
    - DATAHUB_SERVICE_CENTER_DB_DB_NAME
    - DATAHUB_SERVICE_CENTER_DB_HOST
    - DATAHUB_SERVICE_CENTER_DB_PORT
    - ELASTICSEARCH_ESSEN_ENDPOINT
    - BLINK_BAYES_ENDPOINT
    - BLINK_BAYES_RDS_HOST
    - BLINK_BAYES_RDS_PORT
    - BLINK_BAYES_RDS_USER
    - BLINK_BAYES_RDS_PASSWORD
    - BLINK_BAYES_RDS_DB
    - BLINK_BAYES_ADMIN_NAME
    - BLINK_BAYES_ADMIN_PASSWORD
    - BLINK_BAYES_ADMIN_ACCESS_ID
    - BLINK_BAYES_ADMIN_ACCESS_KEY
    - BLINK_AQUILA_HOST
    - BLINK_AQUILA_PORT
    - BLINK_AQUILA_ADMIN_NAME
    - BLINK_AQUILA_ADMIN_PASSWORD
    - BLINK_DRUID_HOST
    - BLINK_DRUID_PORT
    - BLINK_DRUID_ENDPOINT
    - BLINK_DRUID_TOKEN
    - BLINK_SERVER_MASTER_IPS
    - HOLO_MANAGER_ENDPOINT
    - HOLO_MANAGER_PORT
    - GRAPHCOMPUTE_ENDPOINT
    - GRAPHCOMPUTE_PORT
    - GRAPHCOMPUTE_CLUSTER_ID
    - KMS_ENDPOINT
    - KMS_EXISTS
    - TJMON_METRIC
    - TJMON_PROJECT
    - TJMON_ACCOUNT_ID
    - TJMON_ACCOUNT_USER
    - TJMON_ACCESSKEY_ID
    - TJMON_ACCESSKEY_SECRET
    - TJMON_ALERT_API
    - TJMON_METRICS_API
    - TJMON_SITERULE_API
    - TIANJI_SUPERKEY_ID
    - TIANJI_SUPERKEY_IDSECRET
    - TIANJI_API_URL
    - TIANJI_METRICS_API
    - TIANJI_PORTAL_URL
    - YUNDUN_PORTAL_URL
    - ASO_PORTAL_URL
    - PAAS_ABM_URL
    - SLS_ACCESS_ID
    - SLS_ACCESS_KEY
    - SLS_BACKEND_SERVER
    - AAS_AK_ID
    - AAS_AK_KEY
    - AAS_ENDPOINT
    - AAS_LOGIN_URL
    - AAS_DIRECT_LOGIN_URL
    - ASS_CALLBACK_URL
    - AAS_OPENAPI_URL
    - AAS_LOGOUT_URL
    - AAS_OPENAPI_DOMAIN
    - AAS_POP_KEY
    - AAS_POP_SECRET
    - AAS_INNER_ENDPOINT
    - OSS_ACCOUNT_ACCOUNT
    - OSS_ACCOUNT_ACCESS_ID
    - OSS_ACCOUNT_ACCESS_KEY
    - OSS_ENDPOINT
    - OTS_ENDPOINT
---
componentType: K8S_JOB
componentName: paas-productops-postrun
options:
  job:
    name: job
    build:
      imagePush: true
      imagePushRegistry: ${IMAGE_PUSH_REGISTRY}
      args:
        TAG: ack
      dockerfileTemplateArgs:
        POSTRUN_IMAGE: ${POSTRUN_IMAGE}
      dockerfileTemplate: Dockerfile_postrun.tpl
      branch: master
      repo: http://gitlab.ca221ae8860d9421688e59c8ab45c8b21.cn-hangzhou.alicontainer.com/sreworks/github-sreworks.git
      repoPath: paas/tesla-product-ops
      ciAccount: sreworks
      ciToken: zwC8xJJ8z6FVZF6icqXf
 
  env:
    - CLUSTER_SCALE_FLAG
    - CLOUD_TYPE
    - ENV_TYPE
    - NETWORK_PROTOCOL
    - ZONE
    - REGION
    - ABM_CLUSTER
    - COOKIE_DOMAIN
    - CICD_PROJECTID
    - IDC_MAP
    - IDC_ROOM
    - CENTER_REGION
    - REQUESTED_IP
    - CONTAINER_IP_LIST
    - TASK_IP
    - INTERNET_DOMAIN
    - DR_MULTIREGION
    - DR_MULTIZONE
    - VM_IP_LIST
    - DB_HOST
    - DB_PORT
    - DB_NAME
    - DB_NAME_AG
    - DB_NAME_CALIFORNIA
    - DB_NAME_AUTHPROXY
    - DB_NAME_TKGONE
    - DB_NAME_TIANJI
    - DB_NAME_CHECK
    - DB_USER
    - DB_PASSWORD
    - DB_HOST_DI
    - DB_PORT_DI
    - DB_USER_DI
    - DB_PASSWORD_DI
    - DB_NAME_DI
    - REDIS_HOST
    - REDIS_PORT
    - REDIS_DB
    - REDIS_PASSWORD
    - ZOOKEEPER_ENDPOINT
    - ZOOKEEPER_HOSTS
    - ZOOKEEPER_PORT
    - ELASTICSEARCH_HOST
    - ELASTICSEARCH_PORT
    - ELASTICSEARCH_USER
    - ELASTICSEARCH_PASSWORD
    - ENDPOINT_PAAS_NACOS
    - NACOS_NAMESPACE
    - CONTAINER_IP_LIST_TKGONE
    - CONTAINER_IP_LIST_SAAS_TESLA
    - CONTAINER_IP_LIST_SAAS_ODPS
    - CONTAINER_IP_LIST_SAAS_HOLO
    - CONTAINER_IP_LIST_SAAS_GRAPHCOMPUTE
    - CONTAINER_IP_LIST_SAAS_ELASTICSEARCH
    - CONTAINER_IP_LIST_SAAS_DATAWORKS
    - CONTAINER_IP_LIST_SAAS_DATAHUB
    - CONTAINER_IP_LIST_SAAS_BLINK
    - STARAGENT_KEY
    - STARAGENT_SECRET
    - URL_PAAS_HOME
    - URL_PAAS_GATEWAY
    - DNS_PAAS_HOME
    - DNS_PAAS_HOME_DISASTER
    - ENDPOINT_PAAS_HOME
    - ENDPOINT_PAAS_MINIO
    - ENDPOINT_PAAS_PRODUCTOPS
    - ENDPOINT_PAAS_TKGONE
    - ENDPOINT_PAAS_TIANJI
    - ENDPOINT_PAAS_AUTHPROXY
    - ENDPOINT_PAAS_CHANNEL
    - ENDPOINT_PAAS_GRAFANA
    - ENDPOINT_PAAS_FAAS_MANAGER
    - ENDPOINT_PAAS_CMDB
    - ENDPOINT_PAAS_GATEWAY
    - ENDPOINT_PAAS_CONNECTOR
    - ENDPOINT_PAAS_CHECK
    - ENDPOINT_PAAS_STARAGENT
    - ENDPOINT_PAAS_PROCESS
    - ENDPOINT_PAAS_FRONTEND_SERVICE
    - ENDPOINT_PAAS_TASKPLATFORM
    - ENDPOINT_SAAS_BLINK
    - ENDPOINT_SAAS_DATAHUB
    - ENDPOINT_SAAS_DATAWORKS
    - ENDPOINT_SAAS_ELASTICSEARCH
    - ENDPOINT_SAAS_GRAPHCOMPUTE
    - ENDPOINT_SAAS_HOLO
    - ENDPOINT_SAAS_ODPS
    - ENDPOINT_SAAS_TESLA
    - ENDPOINT_SAAS_CALIFORNIA
    - ENDPOINT_SAAS_BASE_CONSOLE
    - ENDPOINT_SAAS_EBLINK
    - ENDPOINT_SAAS_STANDARD_CLUSTER
    - ENDPOINT_SAAS_DWG
    - ENDPOINT_GRPC_PAAS_TIANJI
    - ENDPOINT_GRPC_PAAS_TASKPLATFORM
    - ENDPOINT_GRPC_PAAS_CHECK
    - ENDPOINT_PAAS_DR_MUTILCLOUD
    - VIP_IP_PAAS_HOME
    - VIP_IP_PAAS_GRAFANA
    - VIP_IP_PAAS_TKGONE
    - VIP_IP_PAAS_TASKPLATFORM_GRPC
    - VIP_PORT_PAAS_TKGONE
    - VIP_PORT_PAAS_TASKPLATFORM_GRPC
    - MINIO_ACCESS_KEY
    - MINIO_SECRET_KEY
    - ACCOUNT_SUPER_CLIENT_ID
    - ACCOUNT_SUPER_CLIENT_SECRET
    - ACCOUNT_SUPER_ID
    - ACCOUNT_SUPER_PK
    - ACCOUNT_SUPER_ACCESS_ID
    - ACCOUNT_SUPER_ACCESS_KEY
    - ACCOUNT_SUPER_SECRET_KEY
    - ACCOUNT_ODPS_ID
    - ACCOUNT_ODPS_PK
    - ACCOUNT_ODPS_ACCESS_ID
    - ACCOUNT_ODPS_ACCESS_KEY
    - ACCOUNT_ODPS_SECRET_KEY
    - ACCOUNT_BASE_ID
    - ACCOUNT_BASE_PK
    - ACCOUNT_BASE_ACCESS_ID
    - ACCOUNT_BASE_ACCESS_KEY
    - ACCOUNT_BASE_SECRET_KEY
    - ODPS_SERVICE_ENDPOINT
    - ODPS_ACCOUNT_ID
    - ODPS_ACCOUNT_KEY
    - ODPS_CLUSTER_NAME
    - ODPS_LOGVIEW_HOST
    - ODPS_GRIP_ENDPOINT
    - ODPS_GRIP_PORT
    - ODPS_CONTROLLER_IP
    - ODPS_OTS_HOST
    - ODPS_OTS_TABLE_NAME
    - ODPS_OTS_ACCESS_ID
    - ODPS_OTS_ACCESS_KEY
    - DATAWORKS_INTEGRATE_FLAG
    - DATAWORKS_TENANT_URL
    - DATAWORKS_KEY
    - DATAWORKS_TOKEN
    - DATAWORKS_IDE_URL
    - DATAWORKS_CLUSTER
    - DATAWORKS_API_DOMAIN
    - DATAWORKS_CONSOLE_URL
    - DATAWORKS_ALISA_URL
    - BASE_KEY
    - BASE_TOKEN
    - BASE_IDE_URL
    - BASE_TENANT_URL
    - BASE_CLOUDOPENAPI_URL
    - BASE_META_URL
    - EXTERNAL_DATAWORKS_CONSOLE_URL
    - DATAHUB_DB_HOST
    - DATAHUB_DB_PORT
    - DATAHUB_DB_USER
    - DATAHUB_DB_NAME
    - DATAHUB_DB_PASSWORD
    - DATAHUB_SERVICE_CENTER_DB_USER
    - DATAHUB_SERVICE_CENTER_DB_PASSWORD
    - DATAHUB_SERVICE_CENTER_DB_DB_NAME
    - DATAHUB_SERVICE_CENTER_DB_HOST
    - DATAHUB_SERVICE_CENTER_DB_PORT
    - ELASTICSEARCH_ESSEN_ENDPOINT
    - BLINK_BAYES_ENDPOINT
    - BLINK_BAYES_RDS_HOST
    - BLINK_BAYES_RDS_PORT
    - BLINK_BAYES_RDS_USER
    - BLINK_BAYES_RDS_PASSWORD
    - BLINK_BAYES_RDS_DB
    - BLINK_BAYES_ADMIN_NAME
    - BLINK_BAYES_ADMIN_PASSWORD
    - BLINK_BAYES_ADMIN_ACCESS_ID
    - BLINK_BAYES_ADMIN_ACCESS_KEY
    - BLINK_AQUILA_HOST
    - BLINK_AQUILA_PORT
    - BLINK_AQUILA_ADMIN_NAME
    - BLINK_AQUILA_ADMIN_PASSWORD
    - BLINK_DRUID_HOST
    - BLINK_DRUID_PORT
    - BLINK_DRUID_ENDPOINT
    - BLINK_DRUID_TOKEN
    - BLINK_SERVER_MASTER_IPS
    - HOLO_MANAGER_ENDPOINT
    - HOLO_MANAGER_PORT
    - GRAPHCOMPUTE_ENDPOINT
    - GRAPHCOMPUTE_PORT
    - GRAPHCOMPUTE_CLUSTER_ID
    - KMS_ENDPOINT
    - KMS_EXISTS
    - TJMON_METRIC
    - TJMON_PROJECT
    - TJMON_ACCOUNT_ID
    - TJMON_ACCOUNT_USER
    - TJMON_ACCESSKEY_ID
    - TJMON_ACCESSKEY_SECRET
    - TJMON_ALERT_API
    - TJMON_METRICS_API
    - TJMON_SITERULE_API
    - TIANJI_SUPERKEY_ID
    - TIANJI_SUPERKEY_IDSECRET
    - TIANJI_API_URL
    - TIANJI_METRICS_API
    - TIANJI_PORTAL_URL
    - YUNDUN_PORTAL_URL
    - ASO_PORTAL_URL
    - PAAS_ABM_URL
    - SLS_ACCESS_ID
    - SLS_ACCESS_KEY
    - SLS_BACKEND_SERVER
    - AAS_AK_ID
    - AAS_AK_KEY
    - AAS_ENDPOINT
    - AAS_LOGIN_URL
    - AAS_DIRECT_LOGIN_URL
    - ASS_CALLBACK_URL
    - AAS_OPENAPI_URL
    - AAS_LOGOUT_URL
    - AAS_OPENAPI_DOMAIN
    - AAS_POP_KEY
    - AAS_POP_SECRET
    - AAS_INNER_ENDPOINT
    - OSS_ACCOUNT_ACCOUNT
    - OSS_ACCOUNT_ACCESS_ID
    - OSS_ACCOUNT_ACCESS_KEY
    - OSS_ENDPOINT
    - OTS_ENDPOINT
---
componentType: K8S_MICROSERVICE
componentName: paas-tkgone
options:
  containers:
    - ports:
        - containerPort: 7001
      name: server
      build:
        imagePush: true
        imagePushRegistry: ${IMAGE_PUSH_REGISTRY}
        args:
          TAG: ack
        dockerfileTemplateArgs:
          MAVEN_IMAGE: ${MAVEN_IMAGE}
          JRE8_IMAGE: ${JRE8_IMAGE}
        dockerfileTemplate: Dockerfile.tpl
        branch: master
        repo: http://gitlab.ca221ae8860d9421688e59c8ab45c8b21.cn-hangzhou.alicontainer.com/sreworks/github-sreworks.git
        repoPath: paas/tkg-one
        ciAccount: sreworks
        ciToken: zwC8xJJ8z6FVZF6icqXf
 
  initContainers:
    - name: db-migration
      build:
        imagePush: true
        imagePushRegistry: ${IMAGE_PUSH_REGISTRY}
        args:
          TAG: ack
        dockerfileTemplateArgs:
          MIGRATE_IMAGE: ${MIGRATE_IMAGE}
        dockerfileTemplate: Dockerfile_db_migration.tpl
        repo: http://gitlab.ca221ae8860d9421688e59c8ab45c8b21.cn-hangzhou.alicontainer.com/sreworks/github-sreworks.git
        repoPath: paas/tkg-one
        ciAccount: sreworks
        ciToken: zwC8xJJ8z6FVZF6icqXf
        branch: master


  env:
    - CLOUD_TYPE
    - AAS_LOGIN_URL
    - BLINK_AQUILA_PORT
    - DATAHUB_DB_NAME
    - AAS_OPENAPI_URL
    - TJMON_ACCOUNT_ID
    - ZONE
    - DB_PORT
    - ABM_CLUSTER
    - BLINK_DRUID_PORT
    - AAS_POP_KEY
    - DB_PASSWORD
    - ODPS_SERVICE_ENDPOINT
    - STARAGENT_SECRET
    - ACCOUNT_SUPER_SECRET_KEY
    - DB_NAME_TIANJI
    - TJMON_ACCESSKEY_SECRET
    - ENDPOINT_PAAS_PRODUCTOPS
    - REDIS_DB
    - BLINK_BAYES_ENDPOINT
    - VIP_IP_PAAS_GRAFANA
    - ELASTICSEARCH_USER
    - CICD_PROJECTID
    - ZOOKEEPER_PORT
    - TIANJI_SUPERKEY_ID
    - ELASTICSEARCH_HOST
    - AAS_OPENAPI_DOMAIN
    - ENDPOINT_PAAS_TIANJI
    - DNS_PAAS_HOME
    - ODPS_ACCOUNT_KEY
    - ACCOUNT_BASE_PK
    - KMS_ENDPOINT
    - DATAWORKS_IDE_URL
    - COOKIE_DOMAIN
    - ENDPOINT_PAAS_DR_MUTILCLOUD
    - CLUSTER_SCALE_FLAG
    - IDC_ROOM
    - BLINK_BAYES_ADMIN_ACCESS_KEY
    - MINIO_SECRET_KEY
    - AAS_POP_SECRET
    - BLINK_BAYES_RDS_DB
    - BLINK_AQUILA_ADMIN_NAME
    - ENDPOINT_PAAS_CHANNEL
    - DB_USER
    - ODPS_CLUSTER_NAME
    - DB_NAME_AG
    - ENDPOINT_PAAS_AUTHPROXY
    - ENDPOINT_SAAS_CALIFORNIA
    - AAS_AK_KEY
    - STARAGENT_KEY
    - AAS_LOGOUT_URL
    - VIP_IP_PAAS_HOME
    - ODPS_GRIP_PORT
    - TJMON_ACCESSKEY_ID
    - REDIS_PASSWORD
    - ENDPOINT_PAAS_STARAGENT
    - TIANJI_SUPERKEY_IDSECRET
    - ACCOUNT_SUPER_ACCESS_KEY
    - ASS_CALLBACK_URL
    - TJMON_ACCOUNT_USER
    - KMS_EXISTS
    - ENDPOINT_PAAS_GATEWAY
    - AAS_ENDPOINT
    - CONTAINER_IP_LIST
    - CONTAINER_IP_LIST_TKGONE
    - ENDPOINT_SAAS_BASE_CONSOLE
    - GRAPHCOMPUTE_PORT
    - TJMON_ALERT_API
    - REGION
    - ENDPOINT_SAAS_GRAPHCOMPUTE
    - ACCOUNT_SUPER_ID
    - BLINK_DRUID_ENDPOINT
    - ENDPOINT_PAAS_FAAS_MANAGER
    - TIANJI_PORTAL_URL
    - ENDPOINT_SAAS_DATAHUB
    - ACCOUNT_BASE_ACCESS_KEY
    - DATAHUB_DB_USER
    - TIANJI_API_URL
    - ENDPOINT_PAAS_PROCESS
    - BLINK_DRUID_HOST
    - ENDPOINT_SAAS_EBLINK
    - ODPS_GRIP_ENDPOINT
    - HOLO_MANAGER_ENDPOINT
    - ELASTICSEARCH_PASSWORD
    - BLINK_SERVER_MASTER_IPS
    - AAS_INNER_ENDPOINT
    - ENDPOINT_PAAS_HOME
    - DATAWORKS_TOKEN
    - ENDPOINT_PAAS_TKGONE
    - ENDPOINT_SAAS_TESLA
    - ENDPOINT_PAAS_CMDB
    - BLINK_AQUILA_ADMIN_PASSWORD
    - ENDPOINT_GRPC_PAAS_CHECK
    - VIP_IP_PAAS_TASKPLATFORM_GRPC
    - ENDPOINT_PAAS_MINIO
    - DATAWORKS_KEY
    - ENDPOINT_SAAS_DATAWORKS
    - ENDPOINT_SAAS_ELASTICSEARCH
    - VIP_PORT_PAAS_TKGONE
    - ACCOUNT_ODPS_SECRET_KEY
    - GRAPHCOMPUTE_CLUSTER_ID
    - GRAPHCOMPUTE_ENDPOINT
    - ODPS_LOGVIEW_HOST
    - BLINK_BAYES_ADMIN_PASSWORD
    - ENDPOINT_SAAS_ODPS
    - ACCOUNT_ODPS_PK
    - REDIS_HOST
    - OSS_ACCOUNT_ACCESS_KEY
    - ENDPOINT_SAAS_STANDARD_CLUSTER
    - ENDPOINT_PAAS_CHECK
    - DATAHUB_DB_HOST
    - BLINK_BAYES_RDS_PORT
    - ODPS_CONTROLLER_IP
    - DATAWORKS_TENANT_URL
    - ACCOUNT_BASE_ACCESS_ID
    - DATAWORKS_CLUSTER
    - BLINK_BAYES_RDS_USER
    - URL_PAAS_GATEWAY
    - ENDPOINT_SAAS_BLINK
    - DATAHUB_DB_PASSWORD
    - BLINK_AQUILA_HOST
    - ACCOUNT_BASE_SECRET_KEY
    - OSS_ACCOUNT_ACCESS_ID
    - ENDPOINT_SAAS_HOLO
    - ELASTICSEARCH_PORT
    - DATAWORKS_API_DOMAIN
    - BLINK_BAYES_RDS_HOST
    - OTS_ENDPOINT
    - ENDPOINT_PAAS_TASKPLATFORM
    - REQUESTED_IP
    - BLINK_BAYES_RDS_PASSWORD
    - VM_IP_LIST
    - VIP_IP_PAAS_TKGONE
    - ENDPOINT_PAAS_GRAFANA
    - AAS_DIRECT_LOGIN_URL
    - AAS_AK_ID
    - ENDPOINT_GRPC_PAAS_TIANJI
    - TJMON_METRICS_API
    - ZOOKEEPER_HOSTS
    - BLINK_BAYES_ADMIN_NAME
    - BLINK_BAYES_ADMIN_ACCESS_ID
    - ENDPOINT_PAAS_CONNECTOR
    - ENV_TYPE
    - DNS_PAAS_HOME_DISASTER
    - NETWORK_PROTOCOL
    - DB_NAME
    - ACCOUNT_SUPER_CLIENT_SECRET
    - OSS_ENDPOINT
    - TJMON_PROJECT
    - ACCOUNT_SUPER_CLIENT_ID
    - BLINK_DRUID_TOKEN
    - ZOOKEEPER_ENDPOINT
    - ACCOUNT_ODPS_ACCESS_KEY
    - ENDPOINT_GRPC_PAAS_TASKPLATFORM
    - ODPS_ACCOUNT_ID
    - REDIS_PORT
    - DATAHUB_DB_PORT
    - ACCOUNT_SUPER_ACCESS_ID
    - MINIO_ACCESS_KEY
    - ACCOUNT_ODPS_ID
    - OSS_ACCOUNT_ACCOUNT
    - ACCOUNT_SUPER_PK
    - TJMON_SITERULE_API
    - VIP_PORT_PAAS_TASKPLATFORM_GRPC
    - URL_PAAS_HOME
    - IDC_MAP
    - ENDPOINT_SAAS_DWG
    - DB_HOST
    - TJMON_METRIC
    - ENDPOINT_PAAS_FRONTEND_SERVICE
    - ACCOUNT_ODPS_ACCESS_ID
    - ELASTICSEARCH_CONTAINER_IP_LIST
    - ACCOUNT_BASE_ID
    - CENTER_REGION
    - HOLO_MANAGER_PORT
    - NACOS_ENDPOINT
---
componentType: K8S_JOB
componentName: paas-tkgone-postrun
options:
  job:
    name: job
    build:
      imagePush: true
      imagePushRegistry: ${IMAGE_PUSH_REGISTRY}
      args:
        TAG: ack
      dockerfileTemplateArgs:
        POSTRUN_IMAGE: ${POSTRUN_IMAGE}
      dockerfileTemplate: Dockerfile_postrun.tpl
      repo: http://gitlab.ca221ae8860d9421688e59c8ab45c8b21.cn-hangzhou.alicontainer.com/sreworks/github-sreworks.git
      repoPath: paas/tkg-one
      ciAccount: sreworks
      ciToken: zwC8xJJ8z6FVZF6icqXf
      branch: master
  env:
    - AAS_AK_ID
    - AAS_AK_KEY
    - AAS_DIRECT_LOGIN_URL
    - AAS_ENDPOINT
    - AAS_INNER_ENDPOINT
    - AAS_LOGIN_URL
    - AAS_LOGOUT_URL
    - AAS_OPENAPI_DOMAIN
    - AAS_OPENAPI_URL
    - AAS_POP_KEY
    - AAS_POP_SECRET
    - ABM_CLUSTER
    - ACCOUNT_BASE_ACCESS_ID
    - ACCOUNT_BASE_ACCESS_KEY
    - ACCOUNT_BASE_ID
    - ACCOUNT_BASE_PK
    - ACCOUNT_BASE_SECRET_KEY
    - ACCOUNT_ODPS_ACCESS_ID
    - ACCOUNT_ODPS_ACCESS_KEY
    - ACCOUNT_ODPS_ID
    - ACCOUNT_ODPS_PK
    - ACCOUNT_ODPS_SECRET_KEY
    - ACCOUNT_SUPER_ACCESS_ID
    - ACCOUNT_SUPER_ACCESS_KEY
    - ACCOUNT_SUPER_CLIENT_ID
    - ACCOUNT_SUPER_CLIENT_SECRET
    - ACCOUNT_SUPER_ID
    - ACCOUNT_SUPER_PK
    - ACCOUNT_SUPER_SECRET_KEY
    - ASS_CALLBACK_URL
    - BLINK_AQUILA_ADMIN_NAME
    - BLINK_AQUILA_ADMIN_PASSWORD
    - BLINK_AQUILA_HOST
    - BLINK_AQUILA_PORT
    - BLINK_BAYES_ADMIN_ACCESS_ID
    - BLINK_BAYES_ADMIN_ACCESS_KEY
    - BLINK_BAYES_ADMIN_NAME
    - BLINK_BAYES_ADMIN_PASSWORD
    - BLINK_BAYES_ENDPOINT
    - BLINK_BAYES_RDS_DB
    - BLINK_BAYES_RDS_HOST
    - BLINK_BAYES_RDS_PASSWORD
    - BLINK_BAYES_RDS_PORT
    - BLINK_BAYES_RDS_USER
    - BLINK_DRUID_ENDPOINT
    - BLINK_DRUID_HOST
    - BLINK_DRUID_PORT
    - BLINK_DRUID_TOKEN
    - BLINK_SERVER_MASTER_IPS
    - CENTER_REGION
    - CICD_PROJECTID
    - CLOUD_TYPE
    - CLUSTER_SCALE_FLAG
    - CONTAINER_IP_LIST
    - CONTAINER_IP_LIST_TKGONE
    - COOKIE_DOMAIN
    - DATAHUB_DB_HOST
    - DATAHUB_DB_NAME
    - DATAHUB_DB_PASSWORD
    - DATAHUB_DB_PORT
    - DATAHUB_DB_USER
    - DATAWORKS_API_DOMAIN
    - DATAWORKS_CLUSTER
    - DATAWORKS_IDE_URL
    - DATAWORKS_KEY
    - DATAWORKS_TENANT_URL
    - DATAWORKS_TOKEN
    - DB_HOST
    - DB_NAME
    - DB_NAME_AG
    - DB_NAME_TIANJI
    - DB_PASSWORD
    - DB_PORT
    - DB_USER
    - DNS_PAAS_HOME
    - DNS_PAAS_HOME_DISASTER
    - ELASTICSEARCH_CONTAINER_IP_LIST
    - ELASTICSEARCH_HOST
    - ELASTICSEARCH_PASSWORD
    - ELASTICSEARCH_PORT
    - ELASTICSEARCH_USER
    - ENDPOINT_GRPC_PAAS_CHECK
    - ENDPOINT_GRPC_PAAS_TASKPLATFORM
    - ENDPOINT_GRPC_PAAS_TIANJI
    - ENDPOINT_PAAS_AUTHPROXY
    - ENDPOINT_PAAS_CHANNEL
    - ENDPOINT_PAAS_CHECK
    - ENDPOINT_PAAS_CMDB
    - ENDPOINT_PAAS_CONNECTOR
    - ENDPOINT_PAAS_DR_MUTILCLOUD
    - ENDPOINT_PAAS_FAAS_MANAGER
    - ENDPOINT_PAAS_FRONTEND_SERVICE
    - ENDPOINT_PAAS_GATEWAY
    - ENDPOINT_PAAS_GRAFANA
    - ENDPOINT_PAAS_HOME
    - ENDPOINT_PAAS_MINIO
    - ENDPOINT_PAAS_PROCESS
    - ENDPOINT_PAAS_PRODUCTOPS
    - ENDPOINT_PAAS_STARAGENT
    - ENDPOINT_PAAS_TASKPLATFORM
    - ENDPOINT_PAAS_TIANJI
    - ENDPOINT_PAAS_TKGONE
    - ENDPOINT_SAAS_BASE_CONSOLE
    - ENDPOINT_SAAS_BLINK
    - ENDPOINT_SAAS_CALIFORNIA
    - ENDPOINT_SAAS_DATAHUB
    - ENDPOINT_SAAS_DATAWORKS
    - ENDPOINT_SAAS_DWG
    - ENDPOINT_SAAS_EBLINK
    - ENDPOINT_SAAS_ELASTICSEARCH
    - ENDPOINT_SAAS_GRAPHCOMPUTE
    - ENDPOINT_SAAS_HOLO
    - ENDPOINT_SAAS_ODPS
    - ENDPOINT_SAAS_STANDARD_CLUSTER
    - ENDPOINT_SAAS_TESLA
    - ENV_TYPE
    - GRAPHCOMPUTE_CLUSTER_ID
    - GRAPHCOMPUTE_ENDPOINT
    - GRAPHCOMPUTE_PORT
    - HOLO_MANAGER_ENDPOINT
    - HOLO_MANAGER_PORT
    - IDC_MAP
    - IDC_ROOM
    - KMS_ENDPOINT
    - KMS_EXISTS
    - MINIO_ACCESS_KEY
    - MINIO_SECRET_KEY
    - NETWORK_PROTOCOL
    - ODPS_ACCOUNT_ID
    - ODPS_ACCOUNT_KEY
    - ODPS_CLUSTER_NAME
    - ODPS_CONTROLLER_IP
    - ODPS_GRIP_ENDPOINT
    - ODPS_GRIP_PORT
    - ODPS_LOGVIEW_HOST
    - ODPS_SERVICE_ENDPOINT
    - OSS_ACCOUNT_ACCESS_ID
    - OSS_ACCOUNT_ACCESS_KEY
    - OSS_ACCOUNT_ACCOUNT
    - OSS_ENDPOINT
    - OTS_ENDPOINT
    - REDIS_DB
    - REDIS_HOST
    - REDIS_PASSWORD
    - REDIS_PORT
    - REGION
    - REQUESTED_IP
    - STARAGENT_KEY
    - STARAGENT_SECRET
    - TIANJI_API_URL
    - TIANJI_PORTAL_URL
    - TIANJI_SUPERKEY_ID
    - TIANJI_SUPERKEY_IDSECRET
    - TJMON_ACCESSKEY_ID
    - TJMON_ACCESSKEY_SECRET
    - TJMON_ACCOUNT_ID
    - TJMON_ACCOUNT_USER
    - TJMON_ALERT_API
    - TJMON_METRIC
    - TJMON_METRICS_API
    - TJMON_PROJECT
    - TJMON_SITERULE_API
    - URL_PAAS_GATEWAY
    - URL_PAAS_HOME
    - VIP_IP_PAAS_GRAFANA
    - VIP_IP_PAAS_HOME
    - VIP_IP_PAAS_TASKPLATFORM_GRPC
    - VIP_IP_PAAS_TKGONE
    - VIP_PORT_PAAS_TASKPLATFORM_GRPC
    - VIP_PORT_PAAS_TKGONE
    - VM_IP_LIST
    - ZONE
    - ZOOKEEPER_ENDPOINT
    - ZOOKEEPER_HOSTS
    - ZOOKEEPER_PORT
---
componentType: K8S_MICROSERVICE
componentName: paas-action
options:
  containers:
    - ports:
        - containerPort: 7001
      name: server
      build:
        imagePush: true
        imagePushRegistry: ${IMAGE_PUSH_REGISTRY}
        args:
          TAG: ack
        dockerfileTemplateArgs:
          MAVEN_IMAGE: ${MAVEN_IMAGE}
          JRE8_IMAGE: ${JRE8_IMAGE}
        dockerfileTemplate: Dockerfile.tpl
        branch: master
        repo: http://gitlab.ca221ae8860d9421688e59c8ab45c8b21.cn-hangzhou.alicontainer.com/sreworks/github-sreworks.git
        repoPath: paas/action
        ciAccount: sreworks
        ciToken: zwC8xJJ8z6FVZF6icqXf
 
  initContainers:
    - name: db-migration
      build:
        imagePush: true
        imagePushRegistry: ${IMAGE_PUSH_REGISTRY}
        args:
          TAG: ack
        dockerfileTemplateArgs:
          MIGRATE_IMAGE: ${MIGRATE_IMAGE}
        dockerfileTemplate: Dockerfile_db_migration.tpl
        branch: master
        repo: http://gitlab.ca221ae8860d9421688e59c8ab45c8b21.cn-hangzhou.alicontainer.com/sreworks/github-sreworks.git
        repoPath: paas/action
        ciAccount: sreworks
        ciToken: zwC8xJJ8z6FVZF6icqXf
  env:
    - DB_HOST
    - DB_PORT
    - DB_USER
    - DB_PASSWORD
    - DB_NAME
    - ENDPOINT_PAAS_TKGONE
    - URL_PAAS_HOME
    - ENDPOINT_PAAS_HOME

---

componentType: K8S_MICROSERVICE
componentName: paas-nacos
options:
  containers:
    - ports:
        - containerPort: 8848
      name: server
      build:
        imagePush: true
        imagePushRegistry: ${IMAGE_PUSH_REGISTRY}
        args:
          TAG: ack
        dockerfileTemplateArgs:
          MAVEN_IMAGE: ${MAVEN_IMAGE}
          JRE8_IMAGE: ${JRE8_IMAGE}
        dockerfileTemplate: Dockerfile.tpl
        branch: master
        repo: http://gitlab.ca221ae8860d9421688e59c8ab45c8b21.cn-hangzhou.alicontainer.com/sreworks/github-sreworks.git
        repoPath: paas/nacos
        ciAccount: sreworks
        ciToken: zwC8xJJ8z6FVZF6icqXf
  initContainers:
    - name: db-migration
      build:
        imagePush: true
        imagePushRegistry: ${IMAGE_PUSH_REGISTRY}
        args:
          TAG: ack
        dockerfileTemplateArgs:
          MIGRATE_IMAGE: ${MIGRATE_IMAGE}
        dockerfileTemplate: Dockerfile_db_migration.tpl
        branch: master
        repo: http://gitlab.ca221ae8860d9421688e59c8ab45c8b21.cn-hangzhou.alicontainer.com/sreworks/github-sreworks.git
        repoPath: paas/nacos
        ciAccount: sreworks
        ciToken: zwC8xJJ8z6FVZF6icqXf
  env:
    - DB_HOST
    - DB_PORT
    - DB_USER
    - DB_PASSWORD
    - DB_NAME
    - REGION
    - IDC_ROOM
    - NACOS_SERVERS


